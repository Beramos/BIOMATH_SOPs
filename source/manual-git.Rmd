---
title: "Git hands-on session"
author: "Stijn Van Hoey, Peter Desmet"
date: "March 29, 2017"
output:
  revealjs::revealjs_presentation:
    theme: simple
    highlight: zenburn
    transition: none
    center: true
    fig_width: 7
    fig_height: 6    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Working on your own

---

## Create a repo

1. Go to [GitHub](https://github.com) and login
2. Follow [this tutorial](https://help.github.com/articles/create-a-repo/) to create a repo

---

![Create a repo](manual-git/create-a-repo.png)

---

![Result of creating a repo](manual-git/create-repo-result.png)

---

## Clone a repo to work locally: GitHub Desktop

If you prefer a visual interface to git...

1. Install [GitHub Desktop](https://desktop.github.com/)
2. [Configure git](https://help.github.com/desktop/guides/getting-started/configuring-git-for-github-desktop/)
3. Follow [this tutorial](https://help.github.com/desktop/guides/contributing/cloning-a-repository-from-github-to-github-desktop/) to clone your repo

---

## Clone a repo to work locally: command line

If you prefer working on the command line...

1. Install [git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git)
2. [Configure git](https://help.github.com/articles/set-up-git/)
3. Follow [this tutorial](https://help.github.com/articles/cloning-a-repository/) to clone your repo

---

## Make a commit

1. Open your favourite text editor
2. Update the `README.md`
3. Commit your changes

---

## Make a commit: GitHub Desktop

![Local commit](manual-git/local-commit.png)

---

## Make a commit: command line

1. Check the differences: `git status` and `git diff`
2. Commit your changes: `git commit`

---

## Push your changes to backup your work

* GitHub Desktop: click `Sync`
* Command line: `git push origin master`

---

## Go to your repo on GitHub to verify

![Verify your commits on GitHub](manual-git/local-commit-on-github.png)

---

## Create logical commits

1. Make 2 unrelated changes to your `README.md` locally
2. Create one commit for each change.
3. Do not push (yet)

---

## Create logical commits: GitHub Desktop

![Logical commit 1](manual-git/logical-commit-1.png)

---

## Create logical commits: GitHub Desktop

![Logical commit 2](manual-git/logical-commit-2.png)

---

## Create logical commits: command line

`git add -p README.md`

## Create a conflict

Update your `README.md` on GitHub, on a line you also edited locally

![Commit to create conflict](manual-git/commit-to-create-conflict.png)

---

## Conflict: GitHub Desktop

Try to push your local changes

![Conflict](manual-git/conflict.png)

---

## Conflict: command line

```
git pull origin master
```

## Keep calm and resolve conflict

1. Open `README.md` in text editor:

        <<<<<<< HEAD
        A simple analysis to visualize my favourite fruit colour.
        =======
        A simple analysis to discover my favourite fruit color.
        >>>>>>> origin/master

2. Choose what you want to keep:

        A simple analysis to discover my favourite fruit colour.

3. Commit and push

---

## Add a file

1. Add a `fruits.csv` file in a `/data` directory
2. Link to this file the `README.md`

## Add a file: GitHub Desktop

![Add a file](manual-git/add-file.png)

---

## Add a file: command line

1. `git add data/fruits.csv`
2. `git commit -am "Add data file" data/fruits.csv`
3. `git push origin master`

---

## Undo or adapt last commit: GitHub Desktop

![Undo](manual-git/undo.png)

---

## Undo or adapt last commit: command line

`git revert HEAD`

**Tip**: `git revert` can be applied to any commit. See [this tutorial]() for more in depth information on undoing commits. TODO ADD LINK

---

## View history: GitHub Desktop

![View history](manual-git/view-history.png)

---

## View history: command line

1. `git log`
2. Copy a HASH
3. `git checkout HASH`
4. Check the local directory and files on your computer
5. `git checkout master`

**Tip for Linux users:** Add an alias to your `.bash_aliases`:

```
alias glog="git log --graph --pretty=format:'%C(bold)%h%Creset%C(magenta)%d%Creset %s %C(yellow)<%an> %C(cyan)(%cr)%Creset' --abbrev-commit --date=relative"
```

---

## Create a branch to experiment

1. Create a branch
2. Add a analysis file in a `/src` directory
3. Commit
4. Switch between branches

## Create a branch to experiment: GitHub Desktop

![View history](manual-git/create-branch.png)

---

## Create a branch to experiment: GitHub Desktop

![View history](manual-git/add-file-to-branch.png)

## Create a branch to experiment: command line

1. Create a branch: `git checkout -b analysis-script`
2. Get an overview of your branches: `git branch`
3. `git add` a file to the repository
4. Go back to the status of the master: `git checkout master`
5. Verify your local directory structure: where are your files?
6. Go back to the status of the new branch: `git checkout myfeaturebranch`

---

## Create a pull request to include your work: GitHub Desktop

![Create a pull request](manual-git/create-local-pr.png)

---

## Create a pull request to include your work: command line

TODO: to update

* Go back to the status of the master (`git checkout master`)
* `git merge analysis-script` to the master branch 
* Verify your local folder structure (where is the file?)
* Delete the `analysis-script` (`git branch -d analysis-script`)

---

## Review a pull request

![See pull request](manual-git/pr.png)

## Review a pull request

1. Review
2. If OK, merge pull request
3. Delete branch

## Exclude files: GitHub Desktop

![Ignore file](manual-git/ignore-1.png)

---

## Exclude files: GitHub Desktop

![Ignore file](manual-git/ignore-2.png)

---

## Exclude files: command line

TODO: update

1. Go to master branch `git checkout master`
2. Create a new file `password.txt` with the words `SECRET`
3. `git status` and `git diff`
4. Adapt `.gitignore` to exclude the `password.txt` file
5. `git status` and `git diff`
6. `git commit` your adaptation to the `.gitignore` file
7. `git push` your changes to GitHub
8. Verify the `.gitignore` file on GitHub

---

# Working together

## Invite collaborators

![Invite collaborator](manual-git/invite-collaborator.png)

## Teaming up
* Team up with two or three persons
* Let one person invite the others, provide them with read/write access as explained in [this tutorial](https://help.github.com/articles/inviting-collaborators-to-a-personal-repository/)

## Online collaboration
* All raise an issue online
* provide these issues with an appropriate label

---
* Make an adaptation to an online file
* Propose a `pull request` and assign your collaborator
* Merge the adaptation to the `master` branch

## Working local - merging online

* As collaborator, `git clone` the other repository to your local computer
* Create each a new branch with a different name (`git checkout -b mybranchname`)
* Adapt the content of a file
* `git commit` your adaptation
* `git push origin mybranchname` to the remote location
* Go to GitHub and make a `pull request`
* Revise eachother work and **mege online** when appropriate

---
Update your local work
* Locally, go to master branch `git checkout master`
* Get the remote work `git fetch origin`
* Update your local master `git merge --ff-only origin/master`
* Check if all adaptations are represented in your local files

---

## Release

We are satisfied about outcome analysis. A release can be useful...
* ...for publications (DOI)
* ...for code/software development
* ...for course notes

[This tutorial](https://help.github.com/articles/creating-releases/) explains how to create a release.







